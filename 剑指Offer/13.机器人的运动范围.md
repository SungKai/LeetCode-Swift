# 13.机器人的运动范围

`medium`

**<font color=red>回溯算法</font>**

## 题目描述

> 地上有一个m行n列的方格。一个机器人从坐标(0, 0)的格子开始移动，它 每一次可以向左、右、上、下移动一格，但不能进入行坐标和列坐标的数位之和 大于k的格子。例如，当k为18时，机器人能够进入方格(35, 37)，因为3+5+3+7=18。 但它不能进入方格(35, 38)，因为3+5+3+8=19。请问该机器人能够到达多少个格子？

## Core

- 回溯算法

## Code

O(rows * cols), O(rows * cols)

```swift
func movingCount(_ threshold: Int, _ rows: Int, _ cols: Int) -> Int {
    if threshold < 0 || rows <= 0 || cols <= 0 {
        return 0
    }
    
    var visited = Array(repeating: false, count: rows * cols)
    let count = movingCountCore(threshold, rows, cols, 0, 0, &visited)
    return count
}

func movingCountCore(_ threshold: Int, _ rows: Int, _ cols: Int, _ row: Int, _ col: Int, _ visited: inout [Bool]) -> Int {
    var count = 0
    
    if check(threshold, rows, cols, row, col, visited) {
        visited[row * cols + col] = true
        
        count = 1 +
            movingCountCore(threshold, rows, cols, row - 1, col, &visited) +
            movingCountCore(threshold, rows, cols, row, col - 1, &visited) +
            movingCountCore(threshold, rows, cols, row + 1, col, &visited) +
            movingCountCore(threshold, rows, cols, row, col + 1, &visited)
    }
    
    return count
}

func check(_ threshold: Int, _ rows: Int, _ cols: Int, _ row: Int, _ col: Int, _ visited: [Bool]) -> Bool {
    if row >= 0 && row < rows && col >= 0 && col < cols && getDigitSum(row) + getDigitSum(col) <= threshold && !visited[row * cols + col] {
        return true
    }
    
    return false
}

func getDigitSum(_ number: Int) -> Int {
    var num = number
    var sum = 0
    while num > 0 {
        sum += num % 10
        num /= 10
    }
    return sum
}

```

